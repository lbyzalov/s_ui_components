<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Table Frame</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      margin: 0;
      padding: 12px;
    }
    table {
      border-collapse: collapse;
      width: 100%;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    th {
      background: #f5f5f5;
    }
    tr:nth-child(even) td {
      background: #fafafa;
    }
  </style>
</head>
<body>

  <div id="container">
    <em>Waiting for dataâ€¦</em>
  </div>

  <script>
    function escapeHtml(value) {
      return String(value ?? "")
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }

    function renderTable({ columns, rows }) {
      const thead = `
        <thead>
          <tr>
            ${columns.map(c => `<th>${escapeHtml(c)}</th>`).join("")}
          </tr>
        </thead>
      `;

      const tbody = `
        <tbody>
          ${rows.map(row => `
            <tr>
              ${columns.map(c => `<td>${escapeHtml(row[c])}</td>`).join("")}
            </tr>
          `).join("")}
        </tbody>
      `;

      return `<table>${thead}${tbody}</table>`;
    }

    window.addEventListener("message", (event) => {
      // ðŸ”’ SECURITY CHECK
      if (event.origin !== "agentos") {
        print("Blocked message from unknown origin:", event.origin);
        return;
      } 

      const { type, payload } = event.data || {};

      if (type === "ui_component_render") {
        const container = document.getElementById("container");
        container.innerHTML = renderTable(payload);
      }
    });
  </script>
</body>
</html>